// Pole s překládacími páry.
// Pro lepší práci s vícenásobnými překlady ukládáme správné odpovědi jako pole.
const words = [
  { spanish: "Aconcechar", czech: ["Navrhnout", "Doporučit"] },
  { spanish: "Recomendar", czech: ["Doporučit"] },
  { spanish: "Ferrocarril", czech: ["Železnice", "Vlak"] },
  { spanish: "Guía", czech: ["Vést", "Ukazovat"] },
  { spanish: "Anden", czech: ["Nástupiště", "Ostrůvek"] },
  { spanish: "Retraso", czech: ["Zpoždění"] },
  { spanish: "Asunto", czech: ["Případ", "Téma"] },
  { spanish: "Multitud", czech: ["Hodně", "Spousta"] },
  { spanish: "Abrar", czech: ["Obejmout", "Následovat", "Přijmout"] },
  { spanish: "Rica", czech: ["Bohatý"] }
];

let mode = ""; // 'sp2cz' nebo 'cz2sp'
let currentWordPair = null;
let correctAnswers = 0;
let incorrectAnswers = 0;

// Po výběru režimu nastavíme UI a naplníme dropdown slovy podle zvoleného směru.
function chooseMode(selectedMode) {
  mode = selectedMode;
  document.getElementById("modeSelection").style.display = "none";
  document.getElementById("game").style.display = "block";

  // Nastavení nadpisu podle režimu
  const gameTitle = mode === "sp2cz" ? "Překlad: Španělština → Čeština" : "Překlad: Čeština → Španělština";
  document.getElementById("gameTitle").innerText = gameTitle;

  // Naplníme dropdown obsahem
  fillDropdown();
}

// Funkce pro naplnění rozbalovací nabídky
function fillDropdown() {
  const dropdownContent = document.getElementById("dropdownContent");
  dropdownContent.innerHTML = ""; // vymažeme předchozí položky

  // Podle režimu vybereme, co se má zobrazit v nabídce:
  // Pokud je režim španělština → čeština, zobrazíme španělská slova.
  // Pokud je režim čeština → španělština, zobrazíme české ekvivalenty (vždy první, případně s dodatkem, že jich může být víc).
  words.forEach((pair, index) => {
    let text = "";
    if (mode === "sp2cz") {
      text = pair.spanish;
    } else {
      // Zobrazíme první český překlad (můžeš upravit, pokud chceš zobrazit všechny)
      text = pair.czech.join(", ");
    }
    const a = document.createElement("a");
    a.innerText = text;
    a.onclick = function() {
      startGame(index);
    };
    dropdownContent.appendChild(a);
  });
}

// Spustí se po výběru slova z dropdownu
function startGame(index) {
  currentWordPair = words[index];
  document.getElementById("feedback").innerText = "";
  document.getElementById("answer").value = "";

  // Nastavení otázky podle režimu
  if (mode === "sp2cz") {
    document.getElementById("question").innerText = `Přeložte slovo: ${currentWordPair.spanish}`;
  } else {
    document.getElementById("question").innerText = `Přeložte: ${currentWordPair.czech.join(", ")}`;
  }
}

// Zkontroluje odpověď a zobrazí zpětnou vazbu
function checkAnswer() {
  const userAnswer = document.getElementById("answer").value.trim().toLowerCase();

  if (!currentWordPair) {
    document.getElementById("feedback").innerText = "Nejprve si vyberte slovo!";
    return;
  }

  // Určíme, jaká je správná odpověď (jako pole možných odpovědí) podle režimu
  let correctOptions = [];
  if (mode === "sp2cz") {
    correctOptions = currentWordPair.czech.map(item => item.toLowerCase());
  } else {
    correctOptions = [currentWordPair.spanish.toLowerCase()];
  }

  if (correctOptions.includes(userAnswer)) {
    document.getElementById("feedback").innerText = "Správně!";
    document.getElementById("feedback").className = "correct";
    correctAnswers++;
  } else {
    // Zobrazíme všechny správné možnosti
    document.getElementById("feedback").innerText = `Špatně! Správně: ${correctOptions.join(" nebo ")}`;
    document.getElementById("feedback").className = "incorrect";
    incorrectAnswers++;
  }

  // Aktualizace výsledků (můžeš volat ihned nebo po sérii otázek)
  document.getElementById("correctCount").innerText = `Správně: ${correctAnswers}`;
  document.getElementById("incorrectCount").innerText = `Špatně: ${incorrectAnswers}`;
}

// Restart hry (obnoví zadávání, ale zachová skóre)
function restartGame() {
  document.getElementById("feedback").innerText = "";
  document.getElementById("answer").value = "";
  document.getElementById("question").innerText = "Vyberte další slovo z nabídky.";
}
